'use client'

import styles from './Header.module.css'
import Link from 'next/link'
import { useUserStore } from '@/lib/stores/user.store'
import { useEffect, useState } from 'react'
import { usePathname } from 'next/navigation'
import SearchBar from '@/components/features/search/SearchBar/SearchBar'
import ShoppingCart from '@/components/features/shopping/ShoppingCart/ShoppingCart'

interface HeaderProps {
  theme: 'light' | 'dark' | 'transparent'
  brands: string[] | null
}

export default function Header({ theme, brands }: HeaderProps) {
  const session = useUserStore((state) => state.session)
  const pathname = usePathname()
  const [currentTheme, setCurrentTheme] = useState(pathname === '/' ? 'transparent' : theme)
  const [openSearchBar, setOpenSearchBar] = useState(false)

  //---------- EVENTS HANDLERS ----------//
  const handleScroll = () => (window.scrollY > 0 ? setCurrentTheme('dark') : setCurrentTheme('transparent'))
  const handleCloseSearchBar = () => setOpenSearchBar(false)

  //---------- USE EFFECT ----------//
  //-- Use to change theme depending pathname or scroll event --
  //-- When reloading page, the theme is set on the RootLayout --
  useEffect(() => {
    if (pathname === '/') {
      setCurrentTheme('transparent')

      //-- Animate header on scroll, only on the home page --
      document.addEventListener('scroll', handleScroll)
    } else {
      setCurrentTheme('dark')
    }

    return () => document.removeEventListener('scroll', handleScroll)
  }, [pathname])

  return (
    <header className={`${styles['header']} ${styles[currentTheme]}`}>
      {/* //---------- LOGO ----------// */}
      <Link href="/">
        <svg className={`${styles['logo']}`} width="285" height="68" viewBox="0 0 285 68" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="36" r="32" fill="#514E49" />
          <path d="M44.7521 37.1065L45.0929 35.4025" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path d="M37.1412 46.0805C39.1481 45.1339 43.4798 42.0138 44.7521 37.1064" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path d="M12.8317 48.9204C14.2327 45.7019 19.3293 38.6514 28.5079 36.1977" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path
            d="M28.5079 36.1977C31.4614 35.4783 37.0276 34.0394 38.3907 33.585C39.7539 33.1306 45.5473 31.1995 49.1823 26.5421"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M49.1831 26.542C49.789 25.7469 51.0688 23.5886 51.3415 21.3166C51.6141 19.0447 51.3793 17.4922 51.2279 17M11.015 49.3748C11.1286 47.633 11.4694 43.854 11.9237 42.6726C12.4917 41.1959 14.65 30.2907 29.6447 28.4732"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M29.6438 28.4732C31.193 28.2872 33.4711 27.9698 35.778 27.5644C39.1095 26.9789 42.5009 26.2115 43.8433 25.4061"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M43.8433 25.4061C45.2443 24.8381 48.4325 23.1796 49.9774 21.0894C51.5223 18.9993 51.4542 17.4922 51.227 17"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M22.7146 44.831C18.6251 46.285 15.1794 48.8447 13.9677 49.9428C13.5133 50.17 11.355 53.0099 11.355 53.2371"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path d="M11.0141 49.3748C10.9763 49.8291 10.9914 51.2377 11.3549 53.237" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path d="M22.7144 44.8309C24.8728 43.9979 29.7119 42.2182 31.8021 41.7639" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path
            d="M31.8022 41.7639C33.3547 41.3474 36.6641 40.3098 37.482 39.9463C39.3374 39.189 43.4117 37.2655 44.8657 35.6297"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path
            d="M44.8657 35.6297C45.5094 34.986 46.8877 33.5623 47.2512 33.017C47.7056 32.3354 49.7503 28.7004 49.6367 26.7692"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path d="M49.6366 26.7692V25.8605" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path d="M14.7628 51.4195C16.7317 50.5865 21.0105 48.875 22.3737 48.6932" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path
            d="M22.3736 48.6932C23.396 48.4282 25.9178 47.8753 27.8262 47.7844C29.7346 47.6936 31.5749 47.5194 32.2565 47.4437C33.4303 47.3301 36.0506 46.8075 37.1411 46.0805"
            stroke="#F4EFE9"
            strokeWidth="2"
            strokeLinecap="round"
          />
          <path d="M12.8318 48.9204C12.4152 49.7156 11.5368 51.6921 11.355 53.237" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path d="M14.7629 51.4195C13.9298 51.7981 12.082 52.6918 11.355 53.237" stroke="#F4EFE9" strokeWidth="2" strokeLinecap="round" />
          <path
            d="M85.2734 58L80.6592 15.0312H89.0576L91.4258 42.1553L93.8428 15.0312H101.851L104.146 42.1553L106.44 15.0312H114.937L110.249 58H99.9463L97.7979 37.3213L95.7471 58H85.2734ZM117.305 19.1328V11.8574H126.045V19.1328H117.305ZM117.305 58V21.3789H126.045V58H117.305ZM129.512 58V21.3789H138.252V26.042C138.577 24.6423 139.18 23.4541 140.059 22.4775C140.954 21.4847 142.191 20.9883 143.77 20.9883C146.309 20.9883 148.148 21.7695 149.287 23.332C150.443 24.8945 151.021 27.0348 151.021 29.7529V58H142.402V30.6562C142.402 29.9401 142.256 29.2809 141.963 28.6787C141.67 28.0602 141.165 27.751 140.449 27.751C139.782 27.751 139.285 27.987 138.96 28.459C138.651 28.9147 138.455 29.4925 138.374 30.1924C138.293 30.876 138.252 31.5596 138.252 32.2432V58H129.512ZM164.326 64.3477C162.633 64.3477 161.177 64.2581 159.956 64.0791C158.752 63.9163 157.669 63.6152 156.709 63.1758C155.749 62.7363 154.788 62.1178 153.828 61.3203L156.782 56.2666C158.914 57.5361 161.047 58.1709 163.179 58.1709C164.578 58.1709 165.62 57.7233 166.304 56.8281C166.987 55.9329 167.329 54.7692 167.329 53.3369V49.748C166.629 52.2546 164.766 53.5078 161.738 53.5078C159.997 53.5078 158.589 53.0928 157.515 52.2627C156.44 51.4326 155.659 50.3096 155.171 48.8936C154.683 47.4775 154.438 45.8988 154.438 44.1572V30.998C154.438 29.0286 154.65 27.2952 155.073 25.7979C155.496 24.2842 156.237 23.1042 157.295 22.2578C158.353 21.4115 159.834 20.9883 161.738 20.9883C163.35 20.9883 164.603 21.3952 165.498 22.209C166.41 23.0228 167.02 24.1214 167.329 25.5049V21.3789H176.24V52.7754C176.24 56.9258 175.28 59.888 173.359 61.6621C171.455 63.4525 168.444 64.3477 164.326 64.3477ZM165.278 46.916C166.646 46.916 167.329 45.679 167.329 43.2051V30.7539C167.329 30.0866 167.134 29.403 166.743 28.7031C166.369 28.0033 165.848 27.6533 165.181 27.6533C164.334 27.6533 163.805 27.9707 163.594 28.6055C163.382 29.224 163.276 29.9401 163.276 30.7539V43.2051C163.276 44.084 163.382 44.9222 163.594 45.7197C163.822 46.5173 164.383 46.916 165.278 46.916ZM179.805 58V15.0312H192.988C195.186 15.0312 196.846 15.5358 197.969 16.5449C199.092 17.5378 199.84 18.9375 200.215 20.7441C200.605 22.5345 200.801 24.6423 200.801 27.0674C200.801 29.4111 200.5 31.2829 199.897 32.6826C199.312 34.0824 198.197 35.0508 196.553 35.5879C197.904 35.8646 198.848 36.54 199.385 37.6143C199.938 38.6722 200.215 40.0475 200.215 41.7402V58H191.743V41.1787C191.743 39.9255 191.483 39.1523 190.962 38.8594C190.457 38.5501 189.635 38.3955 188.496 38.3955V58H179.805ZM188.545 30.9492H190.62C191.808 30.9492 192.402 29.6553 192.402 27.0674C192.402 25.391 192.272 24.2923 192.012 23.7715C191.751 23.2507 191.263 22.9902 190.547 22.9902H188.545V30.9492ZM210.542 58.3906C208.589 58.3906 207.091 57.9837 206.05 57.1699C205.024 56.3561 204.325 55.2249 203.95 53.7764C203.576 52.3115 203.389 50.6025 203.389 48.6494V21.3789H212.178V47.624C212.178 49.0889 212.292 50.1143 212.52 50.7002C212.747 51.2699 213.285 51.5547 214.131 51.5547C215.042 51.5547 215.612 51.1478 215.84 50.334C216.084 49.5202 216.206 48.4704 216.206 47.1846V21.3789H224.922V58H216.182V54.0938C215.628 55.4935 214.961 56.5596 214.18 57.292C213.415 58.0244 212.202 58.3906 210.542 58.3906ZM228.438 58V21.3789H237.178V26.042C237.503 24.6423 238.105 23.4541 238.984 22.4775C239.88 21.4847 241.117 20.9883 242.695 20.9883C245.234 20.9883 247.074 21.7695 248.213 23.332C249.368 24.8945 249.946 27.0348 249.946 29.7529V58H241.328V30.6562C241.328 29.9401 241.182 29.2809 240.889 28.6787C240.596 28.0602 240.091 27.751 239.375 27.751C238.708 27.751 238.211 27.987 237.886 28.459C237.576 28.9147 237.381 29.4925 237.3 30.1924C237.218 30.876 237.178 31.5596 237.178 32.2432V58H228.438Z"
            fill="#514E49"
          />
        </svg>
      </Link>

      {/* //---------- LINKS ----------// */}
      <nav>
        <ul className={styles['links']}>
          <li>
            <Link href="/collections/nouveautes">nouveaut√©s</Link>
          </li>
          <li>
            <Link href="/collections?adults=MEN">hommes</Link>
          </li>
          <li>
            <Link href="/collections?adults=WOMEN">femmes</Link>
          </li>
          <li>
            <Link href="/collections?kids=BOY,GIRL">enfants</Link>
          </li>
        </ul>

        {/* //---------- ICONS ----------// */}
        <ul className={styles['icons']}>
          <li>
            <button className={styles['search-button']} type="button" onClick={() => setOpenSearchBar((prev) => !prev)}>
              <svg className={styles['search-icon']} width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M7.91029 13.8426C8.68934 13.8426 9.46076 13.6892 10.1805 13.3911C10.9003 13.0929 11.5542 12.656 12.1051 12.1051C12.656 11.5542 13.0929 10.9002 13.3911 10.1805C13.6892 9.46075 13.8426 8.68933 13.8426 7.91029C13.8426 7.13124 13.6892 6.35982 13.3911 5.64008C13.0929 4.92033 12.656 4.26636 12.1051 3.71549C11.5542 3.16462 10.9003 2.72765 10.1805 2.42952C9.46076 2.13139 8.68934 1.97794 7.91029 1.97794C6.33694 1.97794 4.82802 2.60296 3.71549 3.71549C2.60296 4.82802 1.97795 6.33693 1.97795 7.91029C1.97795 9.48364 2.60296 10.9926 3.71549 12.1051C4.82802 13.2176 6.33694 13.8426 7.91029 13.8426ZM14.159 12.761L17.6987 16.3006C17.793 16.3919 17.8683 16.501 17.92 16.6217C17.9717 16.7424 17.9989 16.8721 18 17.0034C18.001 17.1347 17.9759 17.2648 17.9261 17.3863C17.8763 17.5078 17.8028 17.6181 17.7099 17.7109C17.617 17.8037 17.5066 17.877 17.385 17.9266C17.2635 17.9763 17.1333 18.0012 17.002 18C16.8707 17.9987 16.741 17.9714 16.6204 17.9195C16.4998 17.8676 16.3908 17.7922 16.2996 17.6977L12.76 14.158C11.1706 15.3918 9.17071 15.9735 7.16752 15.7847C5.16432 15.5959 3.30838 14.6507 1.9775 13.1417C0.646626 11.6326 -0.0591376 9.67313 0.00388472 7.66204C0.0669071 5.65096 0.893978 3.73948 2.31673 2.31673C3.73948 0.893977 5.65096 0.066907 7.66205 0.00388471C9.67314 -0.0591376 11.6327 0.646625 13.1417 1.9775C14.6507 3.30838 15.5959 5.16432 15.7847 7.16751C15.9735 9.17071 15.3918 11.1706 14.158 12.76L14.159 12.761Z"
                  fill="#514E49"
                />
              </svg>
            </button>
            {openSearchBar && <SearchBar close={handleCloseSearchBar} brands={brands} />}
          </li>
          <li>
            <Link href={session ? '/account/profil' : '/login'} title="Compte utilisateur">
              <svg className={styles['account-icon']} width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M9 0C10.1935 0 11.3381 0.474106 12.182 1.31802C13.0259 2.16193 13.5 3.30653 13.5 4.5C13.5 5.69347 13.0259 6.83807 12.182 7.68198C11.3381 8.52589 10.1935 9 9 9C7.80653 9 6.66193 8.52589 5.81802 7.68198C4.97411 6.83807 4.5 5.69347 4.5 4.5C4.5 3.30653 4.97411 2.16193 5.81802 1.31802C6.66193 0.474106 7.80653 0 9 0ZM9 2.25C8.40326 2.25 7.83097 2.48705 7.40901 2.90901C6.98705 3.33097 6.75 3.90326 6.75 4.5C6.75 5.09674 6.98705 5.66903 7.40901 6.09099C7.83097 6.51295 8.40326 6.75 9 6.75C9.59674 6.75 10.169 6.51295 10.591 6.09099C11.0129 5.66903 11.25 5.09674 11.25 4.5C11.25 3.90326 11.0129 3.33097 10.591 2.90901C10.169 2.48705 9.59674 2.25 9 2.25ZM9 10.125C12.0038 10.125 18 11.6212 18 14.625V18H0V14.625C0 11.6212 5.99625 10.125 9 10.125ZM9 12.2625C5.65875 12.2625 2.1375 13.905 2.1375 14.625V15.8625H15.8625V14.625C15.8625 13.905 12.3413 12.2625 9 12.2625Z"
                  fill="#514E49"
                />
              </svg>
            </Link>
          </li>
          <li>
            {/* <Link href="/" title="Panier">
              <svg className={styles['cart-icon']} width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5.28305 5H4.14659C2.93858 5 2.3355 5 1.90712 5.265C1.52985 5.498 1.23993 5.865 1.08846 6.304C0.916554 6.803 1.01505 7.444 1.21391 8.724V8.726L2.08089 14.326C2.22864 15.276 2.30205 15.751 2.52228 16.108C2.71742 16.422 2.98968 16.67 3.30934 16.825C3.67175 17 4.11964 17 5.0145 17H12.9855C13.8804 17 14.3273 17 14.6907 16.825C15.0103 16.67 15.2835 16.422 15.4777 16.108C15.698 15.751 15.7714 15.276 15.9182 14.326L16.7861 8.726V8.722C16.9849 7.442 17.0834 6.802 16.9115 6.304C16.7603 5.8654 16.4709 5.49775 16.0938 5.265C15.6654 5 15.0614 5 13.8534 5H12.717M5.28305 5H12.717M5.28305 5C5.28305 3.93913 5.67465 2.92172 6.37172 2.17157C7.06878 1.42143 8.0142 1 9 1C9.9858 1 10.9312 1.42143 11.6283 2.17157C12.3253 2.92172 12.717 3.93913 12.717 5"
                  stroke="#514E49"
                  strokeWidth="2"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            </Link> */}
            <ShoppingCart />
          </li>
        </ul>
      </nav>
    </header>
  )
}
